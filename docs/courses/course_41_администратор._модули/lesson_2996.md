# Добавление ноды веб-кластера

**Навигация**
- [← Оглавление курса](index.md)
- [← Предыдущий: 2990 — Способы балансировки нагрузки между нодами веб-сервера](lesson_2990.md)
- [Следующий: 3001 — Нагрузочное тестирование кластера, анализ различных сценариев и выводы →](lesson_3001.md)

Официальная страница урока: https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=41&LESSON_ID=2996

|  | ### + ещё одна нода |
| --- | --- |





Задача: в связи с растущей нагрузкой необходимо добавить ноду к веб-кластеру. Фактически, необходимо запустить новый физический/виртуальный сервер и прописать его в настройках веб-кластера.




Так как наш демо-кластер мы запускали в «облаке» Амазона, мы  опишем последовательность действий именно для *AWS*. Однако и для любой другой среды ( VPS или несколько выделенных серверов) общая схема будет примерно такой же.




На облачном хостинге *AWS необходимо*:



1. Создать
  			снапшот
                      **Снапшот** (от англ. snapshot - моментальный снимок) - это полный снимок текущего состояния какой либо системы, который позволяет в любой момент вернуть её к сохраненной конфигурации.
  		 диска с данными приложения одной из нод.
2. Создать из снапшота новый диск.
3. Запустить виртуальную машину с AMI, аналогичной оригинальной ноде.
4. Выбрать для виртуальной машины аппаратную конфигурацию в зависимости от ожидаемой нагрузки. В самом простом случае рекомендуется ее выбрать аналогичной оригинальной ноде.
5. Остановить новую ноду.
6. Отключить от нее диск.
7. Вместо отключенного диска подключить диск созданный в шаге 2.
8. Запустить новую ноду.
9. Привязать при необходимости к новой ноде
  			эластичный IP-адрес
                      В AWS **эластичный IP-адрес** – это статический IPv4-адрес для динамических облачных вычислений.
  Подробнее информацию вы найдёте в [официальной документации AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html).
  		.
10. Настроить новую ноду: если используется csync2, то прописать в его настройки на всех нодах веб-кластера доменное имя новой ноды. Запустить на ней необходимые сервисы: memcached, mysql-slave.
11. Рекомендуется в инициализационные скрипты новой ноды добавить ее привязку к эластичному IP-адресу. Иначе при ее остановке/запуске нужно будет снова привязывать к ней IP-адрес вручную.
12. Теперь с новой нодой синхронизируется контент с текущих нод веб-кластера. Ее необходимо добавить в балансировщик нагрузки.
  **Примечание**. Если новая нода используется как mysql-slave, memcached-сервер, необходимо зарегистрировать её в административном интерфейсе веб-кластера (Настройки &gt; Веб-кластер).
