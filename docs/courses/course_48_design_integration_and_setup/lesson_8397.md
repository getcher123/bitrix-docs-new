# Настройка модуля

**Навигация**
- [← Оглавление курса](index.md)
- [← Предыдущий: 20240 — Проверьте себя](lesson_20240.md)
- [Следующий: 2184 — Добавление собственного типа коннекторов →](lesson_2184.md)

Официальная страница урока: https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=48&LESSON_ID=8397

### Общие серверные настройки

1. Полный доступ из вне к http://адрес сайта/pub/imconnector/, к корню и всем файлам и поддиректориям.
2. **Действующий лицензионный ключ**.
3. Доступ со стороны портала ко всем внешним адресам (социальная сеть Вконтакте и т.п.) по http и https.
4. Настройка параметра Nginx: `nginx proxy_ignore_client_abort on`. Эту настройку необходимо включать для конкретного `location`. Если используется php-fpm, вместо nginx proxy_ignore_client_abort on нужно использовать параметр `fastcgi_ignore_client_abort on`.
5. Для работы коннектора **Онлайн-чат**:
  Для работы коннектора **Битрикс24.Нетворк**:
  - установленный и настроенный модуль **Чат-боты Битрикс24 (imbot)**;
  - доступ без авторизации к странице `/pub/imbot.php`;
  - если возникают проблемы с прохождением сообщений даже при таких настройках, необходимо включить опцию [Долгое ожидания ответа](#chatbot) в опциях модуля **Чат-боты Битрикс24**.

  - для `location /online/(/?)([^/]*)` разрешить `X-Frame-Options SAMEORIGIN` (открывать эту страницу как фрейм из любого сайта или только того, где будет расположен фрейм). Такие настройки могут быть в Nginx и в модуле **Проактивная защита** в разделе **Защита от фреймов** (Настройки  &gt; Проактивная защита  &gt; Защита от фреймов);

Настройка модуля **Коннекторы для внешних мессенджеров** (Настройки &gt; Настройки продукта &gt; Настройки модулей &gt; Коннекторы для внешних мессенджеров) проста.

- **Публичный адрес сайта** - нужно убедиться, что после установки был верно определен адрес портала. Он должен быть указан вместе с адресом портала и протоколом. Закрывающий слэш не обязателен.
- **Включить режим отладки** - эта опция включает лог ошибок работы коннекторов в файл `/bitrix/modules/imconnector_error.log`.
  **Примечание**: В файл пишется только лог ошибок, включать данную опцию имеет смысл только для отладки, лог трассировки сообщений в этот файл не пишется.
- **Список используемых коннекторов** - здесь выбираются коннекторы (каналы), доступные к подключению.


**Внимание!**

1. Если не удается подключить каналы и происходит ошибка, то нужно в первую очередь в настройках модуля проверить верность указания доменного имени с протоколом и убедиться, что данный адрес доступен из интернета.
2. Нельзя использовать модуль **Коннекторы для внешних мессенджеров** на тестовом и боевом портале с использованием одного лицензионного ключа. На сервере коннекторов постоянно будет меняться привязка к домену и сообщения будут хаотично уходить на то на один портал, то на другой.
