# Добавление дополнительного жесткого диска BitrixVM

**Навигация**
- [← Оглавление курса](index.md)
- [← Предыдущий: 5502 — Изменение стандартных настроек BitrixVM без отключения автоподстройки](lesson_5502.md)
- [Следующий: 6928 — Увеличение размера существующего жесткого диска BitrixVM →](lesson_6928.md)

Официальная страница урока: https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=37&LESSON_ID=6929

**Внимание!** Для операций, описанных в данном уроке, необходимы знания администрирования *nix-систем. Перед началом проведения данных операций рекомендуется сделать полный бекап *«Виртуальной машины»*.





Так как основной объем дискового пространства потребляется контентом сайтов и их резервными копиями, расположенными в `/home/bitrix`, а также БД, расположенной в `/var/lib/mysql`, то на отдельные диски следует выносить именно эти разделы.





Рассмотрим данную задачу на примере переноса на отдельный диск папки `/home` с контентом сайтов и их резервными копиями.




- Для этого, в настройках виртуальной машины в список оборудования, добавляем новый диск необходимого размера. Все указанные ниже действия необходимо осуществлять под учетной записью администратора **root**:
  ![](../../../images/courses/37/dev.1c-bitrix.ru/images/portal_admin/install/vmbitrix/vm_disk_increase1_sm.png)
  ![](../../../images/courses/37/dev.1c-bitrix.ru/images/portal_admin/install/vmbitrix/vm_disk_increase2_sm.png)
- После добавления диска, для его инициализации, возможно, потребуется перезагрузить сервер. Увидеть новый диск и присвоенное ему буквенное обозначение можно, выполнив команду:
  ```
  fdisk -l
  ```
  ![](../../../images/courses/37/dev.1c-bitrix.ru/images/portal_admin/install/vmbitrix/vm_disk_increase3_sm.png)
- Запускаем утилиту **fdisk** для работы с диском `/dev/sdb`:
  ```
  fdisk /dev/sdb
  ```
  И командой **n** создаем новый раздел:
  ![](../../../images/courses/37/dev.1c-bitrix.ru/images/portal_admin/install/vmbitrix/vm_disk_increase4_sm.png)

  - основной (primary partition) - команда **p** и `Partition number (1-4): 1`;
  - первый и последний сектора при этом выбираем по умолчанию - таким образом, будет создан раздел, используя все свободное пространство на диске:
- После сохранения таблицы разделов, форматируем новый раздел и переносим на него информацию из `/home`:
  ```
  mkfs.ext4 /dev/sdb1
  mount /dev/sdb1 /mnt
  service httpd stop
  service nginx stop
  mv -f /home/* /mnt
  umount /mnt
  ```
  Следующим шагом определяем **UUID** нового диска:
  ```
  blkid
  /dev/sda1: UUID="99066558-ba04-465c-9962-e827aa2928ec" TYPE="ext4"
  /dev/sda2: UUID="8ea38ef9-1ee5-423b-a013-15fd603a678e" TYPE="swap"
  /dev/sda3: UUID="08ec5c65-8fd8-47ac-a998-d81195c8f964" TYPE="ext4"
  /dev/sdb1: UUID="b2e58731-b621-4bd5-909a-afe3bb5dd8a1" TYPE="ext4"
  ```
  и добавляем запись (в данном примере: `UUID=b2e58731-b621-4bd5-909a-afe3bb5dd8a1`) о нем в `/etc/fstab` (вместо **UUID** можно также использовать имя устройства `/dev/sdb`):
  ![](../../../images/courses/37/dev.1c-bitrix.ru/images/portal_admin/install/vmbitrix/vm_disk_increase5_sm.png)
  Остается только примонтировать новый диск и запустить остановленные ранее службы:
  ```
  mount /home
  service httpd start
  service nginx start
  ```




Добавление дисков в других средах виртуализации или непосредственно на физическом сервере проходит аналогично.
