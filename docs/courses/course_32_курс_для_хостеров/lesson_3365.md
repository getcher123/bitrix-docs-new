# Настройка веб-сервера Apache

**Навигация**
- [← Оглавление курса](index.md)
- [← Предыдущий: 3364 — Достигнутые результаты](lesson_3364.md)
- [Следующий: 3366 — Пример: число процессов веб-сервера →](lesson_3366.md)

Официальная страница урока: https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=32&LESSON_ID=3365

### Конфигурационные файлы




Основным конфигурационным файлом веб-сервера является `/etc/apache2/apache2.conf` (в других системах файл может называться `/etc/httpd/httpd.conf`). Далее, подключается файл с настройкой портов прослушивания для веб-сервера и другие файлы. Иногда это все размещается в одном файле, иногда (как в виртуальной машине – в разных).



Рассмотрим основные параметры этих файлов.



`/etc/apache2/apache2.conf`



```

Timeout 300 #если 300 секунд не происходит никаких операций, завершить процесс
KeepAlive Off #все запросы у нас короткоживущие
User ${APACHE_RUN_USER} #пользователь, под которым работает веб-сервер
Group ${APACHE_RUN_GROUP} #группа, под которой работает веб-сервер
```




`/etc/apache2/ports.conf`



```

Listen *:8888 #веб-сервер работает на порту 8888
```




`/etc/apache2/envvars` Осуществляется установка переменных окружения – пользователя и группы.



```

export APACHE_RUN_USER=bitrix
export APACHE_RUN_GROUP=bitrix
```




`/etc/apache2/conf.d/prefork` Осуществляется настройка числа процессов сервера.



```

 #работает с этим расширением
StartServers 4 #4 одновременных сервера
MinSpareServers 4
MaxSpareServers 4
MaxClients 4 #4 одновременных клиента
MaxRequestsPerChild 200 #после 200 запросов перезапускать процесс

```



Таким образом, настройки веб-сервера достаточно простые. Фактически, в стандартной конфигурации достаточно изменить только порт, на котором работает веб-сервер и параметр **MaxClients** и связанные с ним.






### Некоторые ключевые моменты настройки





Для конфигурации используются нестандартные порты. Например, 192.168.1.1:8888. В этом случае можно обращаться к *Apache* снаружи мимо фронтенда и проверить его работу. Это достоинство способа. И могут возникнуть лишние редиректы. Это ограничение способа, которое, впрочем, обходится.




Либо использовать внутренние адреса на стандартных портах. Например, 127.0.0.2:80. Нельзя будет обращаться снаружи мимо фронтенда, но зато нет проблем с редиректами.




Ограничение процессов (**StartServers**) зависит от параметров системы. Разумное число - 20-30 процессов, точнее надо вычислять. Посмотрите сколько памяти у вас может занять один процесс, поделите общее количество памяти на размер одного процесса, это даст примерное число процессов.




По логам проверяйте, что бы вся статика отдавалась Frontend'ом. В логах не должно быть обращений к статическим файлам: gif, jpg, css и подобным.
