# Изменение стандартных настроек BitrixVM без отключения автоподстройки

**Навигация**
- [← Оглавление курса](index.md)
- [← Предыдущий: 29380 — 10. Фоновые задачи (10. Background pool tasks)](lesson_29380.md)
- [Следующий: 29394 — Добавление дополнительного жесткого диска BitrixVM →](lesson_29394.md)

Официальная страница урока: https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=32&LESSON_ID=29390

**Внимание!** Приведённые настройки выходят за рамки меню Виртуальной машины. Это означает, что информация - ознакомительная и применять её следует с чётким пониманием того что вы делаете и с собственной ответственностью за совершаемые действия. В нашей техподдержке рассматриваются только вопросы по работе пунктов меню ВМ.




При запуске виртуальной машины *BitrixVM* или физического сервера с установленным пакетом *BitrixEnv* сервисом **bvat** автоматически настраиваются основные параметры **Apache**, **PHP**, **MySQL** и **nginx** в зависимости от количества доступной памяти. Это позволяет обеспечивать оптимальные настройки сервера.




Но в ряде случаев возникает необходимость изменения некоторых параметров без отключения сервиса **bvat**. Для внесения таких изменений в настройки сервера предусмотрены специальные конфигурационные файлы, позволяющие переопределять параметры, устанавливаемые сервисом **bvat**. Они имеют свое название и хранятся в директориях:


- **MySQL**: `/etc/mysql/conf.d/z_bx_custom.cnf`
- **Apache**: `/etc/httpd/bx/custom/z_bx_custom.conf`
- **nginx**:
  Конфигурационный файл nginx в этих директориях может быть как один общий, так несколько. Имя файла не имеет значения, главное, чтобы в них были неконфликтующие настройки.

  - `/etc/nginx/bx/site_ext_enabled/` - конфигурационные файлы своих дополнительных сайтов для всего сервера (например, *bx_ext.conf*, *bx_ext_custom1.conf*, *ext_custom_site.ru.conf* и т.п)
  - `/etc/nginx/bx/settings/` - конфигурационные файлы настроек для уровня http всего сервера (например, *z_bx_custom.conf*, *z_bx_custom1.conf* и т.п)
  - `/etc/nginx/bx/site_settings/<SITE_NAME>/` - персональные настройки конкретного сайта, начиная с версии BitrixVM 7.5 или бета версии 7.4.10 (например, */etc/nginx/bx/site_settings/site.ru/myconfig.conf*).
- **PHP**: `/etc/php.d/z_bx_custom.ini`





В случае, если в этих директориях нет конфигурационных файлов, то их можно создать самостоятельно.





**Внимание!** Все изменения стандартных конфигурационных файлов **Apache**, **PHP**, **MySQL** и **nginx** могут быть утрачены во время обновления виртуальной машины *BitrixVM/BitrixEnv*. Чтобы этого не произошло, все переопределяемые параметры должны быть только в файлах типа **z_bx_custom.***, указанных выше для каждого сервиса.

Для вступления переопределяемых параметров в силу нужно перезапустить соответствующие службы: MySQL, Apache или nginx.





## Пример изменения параметров в файле z_bx_custom.cnf

Пример из практики:



У пользователя CRM Битрикс24 возникла ошибка при попытке конвертировать лида в сделку с большим количеством пользовательских полей. Сообщение об ошибке выдавалось такое:




```
Row size too large (> 8126). Changing some columns to TEXT or BLOB may help. In current row format, BLOB prefix of 0 bytes is stored inline.
```




Проблема решилась и конвертация заработала корректно после внесения в файл **/etc/mysql/conf.d/z_bx_custom.cnf** таких настроек:




```

innodb_file_format = Barracuda
innodb_file_per_table = ON
innodb_strict_mode = OFF
```
