# События, связанные с изменением аффилиатов

**Примечание:**перечисленные ниже события устарели с версии 15.5.0, но в продукте сохранена обратная совместимость. Поэтому их можно использовать, если в настройках модуля **Интернет-магазин**отмечена опция **Включить обработку устаревших событий**. Либо вы можете использовать **события нового ядра**.


| Событие | Описание и параметры | Метод | С версии | До версии |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| OnBeforeBAffiliateAdd | Вызывается до добавления аффилиата. **Параметры** \| *$arFields* \| Массив изменяемых параметров \| \| --- \| --- \| | *$arFields* | Массив изменяемых параметров | CSaleAffiliate::Add | 12.0.4 | 15.5.0 |  |  |  |  |
| *$arFields* | Массив изменяемых параметров |  |  |  |  |  |  |  |  |  |
| OnAfterBAffiliateAdd | Вызывается после добавления аффилиата. **Параметры** \| *$ID* \| Код добавленного аффилиата. \| \| --- \| --- \| \| *arFields* \| Массив параметров \| | *$ID* | Код добавленного аффилиата. | *arFields* | Массив параметров | CSaleAffiliate::Add | 12.0.4 | 15.5.0 |  |  |
| *$ID* | Код добавленного аффилиата. |  |  |  |  |  |  |  |  |  |
| *arFields* | Массив параметров |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliateUpdate | Вызывается до обновления **Параметры** \| *ID* \| Код аффилиата \| \| --- \| --- \| \| *$arFields* \| Массив изменяемых параметров \| | *ID* | Код аффилиата | *$arFields* | Массив изменяемых параметров | CSaleAffiliate::Update | 12.0.4 | 15.5.0 |  |  |
| *ID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| *$arFields* | Массив изменяемых параметров |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliateUpdate | Вызывается после обновления **Параметры** \| *ID* \| Код аффилиата \| \| --- \| --- \| \| *$arFields* \| Массив параметров \| | *ID* | Код аффилиата | *$arFields* | Массив параметров | CSaleAffiliate::Update | 12.0.4 | 15.5.0 |  |  |
| *ID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| *$arFields* | Массив параметров |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliateDelete | Вызывается перед удалением **Параметры** \| *ID* \| Код аффилиата \| \| --- \| --- \| | *ID* | Код аффилиата | CSaleAffiliate::Delete | 12.0.4 | 15.5.0 |  |  |  |  |
| *ID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliateDelete | Вызывается после удаления **Параметры** \| *ID* \| Код аффилиата \| \| --- \| --- \| \| *$bResult* \| Результат удаления (true/false)Массив параметров \| | *ID* | Код аффилиата | *$bResult* | Результат удаления (true/false)Массив параметров | CSaleAffiliate::Delete | 12.0.4 | 15.5.0 |  |  |
| *ID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| *$bResult* | Результат удаления (true/false)Массив параметров |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliateCalculate | Вызывается перед калькуляцией **Параметры** \| *$arAffiliate* \| Массив параметров аффилиата \| \| --- \| --- \| \| *$dateFrom*, *$dateTo* \| Период калькуляции \| \| *$datePlanFrom*, *$datePlanTo* \| Период определения плана \| | *$arAffiliate* | Массив параметров аффилиата | *$dateFrom*, *$dateTo* | Период калькуляции | *$datePlanFrom*, *$datePlanTo* | Период определения плана | CSaleAffiliate::CalculateAffiliate | 12.0.4 | 15.5.0 |
| *$arAffiliate* | Массив параметров аффилиата |  |  |  |  |  |  |  |  |  |
| *$dateFrom*, *$dateTo* | Период калькуляции |  |  |  |  |  |  |  |  |  |
| *$datePlanFrom*, *$datePlanTo* | Период определения плана |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliateCalculate | Вызывается после калькуляции **Параметры** \| *affiliateID* \| Код аффилиата \| \| --- \| --- \| | *affiliateID* | Код аффилиата | CSaleAffiliate::CalculateAffiliate | 12.0.4 | 15.5.0 |  |  |  |  |
| *affiliateID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| OnBeforePayAffiliate | Вызывается перед выплатой суммы на счёт **Параметры** \| *$arAffiliate* \| Массив данных аффилиата. \| \| --- \| --- \| \| *$payType* \| Статус что делать с суммой. \| | *$arAffiliate* | Массив данных аффилиата. | *$payType* | Статус что делать с суммой. | CSaleAffiliate::PayAffiliate | 12.0.4 | 15.5.0 |  |  |
| *$arAffiliate* | Массив данных аффилиата. |  |  |  |  |  |  |  |  |  |
| *$payType* | Статус что делать с суммой. |  |  |  |  |  |  |  |  |  |
| OnAfterPayAffiliate | Вызывается после выплат **Параметры** \| *affiliateID* \| Код аффилиата \| \| --- \| --- \| | *affiliateID* | Код аффилиата | CSaleAffiliate::PayAffiliate | 12.0.4 | 15.5.0 |  |  |  |  |
| *affiliateID* | Код аффилиата |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliatePlanAdd | Вызывается до сохранения плана **Параметры** \| *$arFields* \| Массив параметров плана \| \| --- \| --- \| | *$arFields* | Массив параметров плана | CSaleAffiliatePlan::Add | 12.0.4 | 15.5.0 |  |  |  |  |
| *$arFields* | Массив параметров плана |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliatePlanAdd | Вызывается после сохранения плана **Параметры** \| *$ID* \| Код плана \| \| --- \| --- \| \| *$arFields* \| Массив параметров плана \| | *$ID* | Код плана | *$arFields* | Массив параметров плана | CSaleAffiliatePlan::Add | 12.0.4 | 15.5.0 |  |  |
| *$ID* | Код плана |  |  |  |  |  |  |  |  |  |
| *$arFields* | Массив параметров плана |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliatePlanUpdate | Вызывается до обновления плана. **Параметры** \| *$ID* \| Код плана. \| \| --- \| --- \| \| *$arFields* \| Массив параметров плана \| | *$ID* | Код плана. | *$arFields* | Массив параметров плана | CSaleAffiliatePlan::Update | 12.0.4 | 15.5.0 |  |  |
| *$ID* | Код плана. |  |  |  |  |  |  |  |  |  |
| *$arFields* | Массив параметров плана |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliatePlanUpdate | Вызывается после обновления плана. **Параметры** \| *$ID* \| Код плана. \| \| --- \| --- \| \| *$arFields* \| Массив параметров плана \| | *$ID* | Код плана. | *$arFields* | Массив параметров плана | CSaleAffiliatePlan::Update | 12.0.4 | 15.5.0 |  |  |
| *$ID* | Код плана. |  |  |  |  |  |  |  |  |  |
| *$arFields* | Массив параметров плана |  |  |  |  |  |  |  |  |  |
| OnBeforeAffiliatePlanDelete | Вызывается до удаления плана **Параметры** \| *$ID* \| Код плана \| \| --- \| --- \| | *$ID* | Код плана | CSaleAffiliatePlan::Delete | 12.0.4 | 15.5.0 |  |  |  |  |
| *$ID* | Код плана |  |  |  |  |  |  |  |  |  |
| OnAfterAffiliatePlanDelete | Вызывается после удаления плана **Параметры** \| *$ID* \| Код плана \| \| --- \| --- \| \| *$bResult* \| Результат удаления (true/false) \| | *$ID* | Код плана | *$bResult* | Результат удаления (true/false) | CSaleAffiliatePlan::Delete | 12.0.4 | 15.5.0 |  |  |
| *$ID* | Код плана |  |  |  |  |  |  |  |  |  |
| *$bResult* | Результат удаления (true/false) |  |  |  |  |  |  |  |  |  |
